---
layout: post
category: go
tags: go
---

#go建立http服务,并搭建基础web项目

>设置路由:

1. 使用默认路由:


    http.HandleFunc("uri" , func)  默认的http处理路由  
    如http.HandleFunc("/hello", sayHello) ， 其中sayHello方法需要实现2个参数 http.ResponseWriter 的值 , http.Request 的指针


2. 通过实现handler的接口来实现为外部路由器:

    当定义了外部路由后，默认的路由就不会起作用

    	type mymux struct {
	}

	func (my *mymux) ServeHTTP(w http.ResponseWriter, r *http.Request) {
		if r.URL.Path == "/good" {
			sayGood(w, r)
			return
		}
		http.NotFound(w, r)
		return
	}
	func main() {
		myRouter := &mymux{}

		http.HandleFunc("/hello", sayHello)
		//http listen port
		//err := http.ListenAndServe("127.0.0.1:9090", nil)
		err := http.ListenAndServe("127.0.0.1:9090", myRouter)
		if err != nil {
			log.Fatal("listenAndServe: ", err)
		}
	}




>调用http方法监听端口:

    err := http.ListenAndServe("127.0.0.1:9090", handler) 
    handler为外部的路由方法，需要实现serveHttp(w http.ResponseWriter, r *http.Request)方法，实现了外部handle后，就会取消默认的http处理handler
    返回为err 如果该err值不为nil，则出现错误
    需要先设置路由方法，再调用http监听服务，因为再http监听服务中存在死循环。

>设置view模板

1. 通过"html/template"模块中的template.Parse(模板名)来进行模板调用

    func handleLogin(w http.ResponseWriter, r *http.Request) {
	t, _ := template.ParseFiles("view/login.gtpl")
	t.Execute(w, nil)
    }


